<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Blog Post</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background:#f9f9f9;
      padding:20px;
    }
    #blog-container {
      max-width: 800px;
      margin:auto;
      background:white;
      padding:20px;
      border-radius:10px;
      box-shadow:0 2px 8px rgba(0,0,0,0.1);
    }
    h1, h2, h3 { color:#222; }
    .meta {
      font-size:14px;
      color:gray;
      margin-bottom:20px;
    }
    p { line-height:1.6; margin:10px 0; }
    img { display:block; margin:20px auto; }
    .caption { font-size:12px; color:#555; text-align:center; }
  </style>
</head>
<body>
  <div id="blog-container">Loading blog...</div>

  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script>
    const supabaseUrl = "https://dajryufixunnnkfucgce.supabase.co";
    const supabaseKey = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRhanJ5dWZpeHVubm5rZnVjZ2NlIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTQyNjA2NzAsImV4cCI6MjA2OTgzNjY3MH0.xWeWh3srrDFKLVeP9XHaGpPCcenl7TWQT2-nE8UAp90";
    const supabaseClient = supabase.createClient(supabaseUrl, supabaseKey);

    async function loadBlog() {
      const params = new URLSearchParams(window.location.search);
      const blogId = params.get("id");

      if (!blogId) {
        document.getElementById("blog-container").innerHTML = "<p>No blog ID provided.</p>";
        return;
      }

      const { data, error } = await supabaseClient
        .from("Blogs")
        .select("id, title, date, author, category, content, image_url")
        .eq("id", blogId)
        .maybeSingle();

      if (error) {
        console.error("Error fetching blog:", error);
        document.getElementById("blog-container").innerHTML = "<p>‚ö†Ô∏è Error loading blog.</p>";
        return;
      }

      if (!data) {
        document.getElementById("blog-container").innerHTML = "<p>Blog post not found.</p>";
        return;
      }

      // üöÄ Directly render HTML content stored in Supabase
      document.getElementById("blog-container").innerHTML = `
        <h1>${data.title}</h1>
        <p class="meta"><b>Date:</b> ${new Date(data.date).toLocaleDateString()} | <b>Author:</b> ${data.author} | <b>Category:</b> ${data.category}</p>
        ${data.image_url ? `<img src="${data.image_url}" alt="Blog Image" style="max-width:100%; border-radius:8px;">` : ""}
        <div>${data.content}</div>
      `;
    }

    loadBlog();
  </script>
</body>
</html>